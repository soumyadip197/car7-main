{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file://E%3A/Car7/lib/utils.js"],"sourcesContent":["import { clsx } from \"clsx\";\r\nimport { twMerge } from \"tailwind-merge\"\r\n\r\nexport function cn(...inputs) {\r\n  return twMerge(clsx(inputs));\r\n}\r\n"],"names":[],"mappings":";;;AAAA;AACA;;;AAEO,SAAS,GAAG,GAAG,MAAM;IAC1B,OAAO,CAAA,GAAA,8JAAA,CAAA,UAAO,AAAD,EAAE,CAAA,GAAA,wIAAA,CAAA,OAAI,AAAD,EAAE;AACtB"}},
    {"offset": {"line": 20, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 26, "column": 0}, "map": {"version":3,"sources":["file://E%3A/Car7/components/ui/accordion.jsx"],"sourcesContent":["\"use client\"\r\n\r\nimport * as React from \"react\"\r\nimport * as AccordionPrimitive from \"@radix-ui/react-accordion\"\r\nimport { ChevronDown } from \"lucide-react\"\r\n\r\nimport { cn } from \"@/lib/utils\"\r\n\r\nconst Accordion = AccordionPrimitive.Root\r\n\r\nconst AccordionItem = React.forwardRef(({ className, ...props }, ref) => (\r\n  <AccordionPrimitive.Item ref={ref} className={cn(\"border-b\", className)} {...props} />\r\n))\r\nAccordionItem.displayName = \"AccordionItem\"\r\n\r\nconst AccordionTrigger = React.forwardRef(({ className, children, ...props }, ref) => (\r\n  <AccordionPrimitive.Header className=\"flex\">\r\n    <AccordionPrimitive.Trigger\r\n      ref={ref}\r\n      className={cn(\r\n        \"flex flex-1 items-center justify-between py-4 text-sm font-medium transition-all hover:underline text-left [&[data-state=open]>svg]:rotate-180\",\r\n        className\r\n      )}\r\n      {...props}>\r\n      {children}\r\n      <ChevronDown\r\n        className=\"h-4 w-4 shrink-0 text-muted-foreground transition-transform duration-200\" />\r\n    </AccordionPrimitive.Trigger>\r\n  </AccordionPrimitive.Header>\r\n))\r\nAccordionTrigger.displayName = AccordionPrimitive.Trigger.displayName\r\n\r\nconst AccordionContent = React.forwardRef(({ className, children, ...props }, ref) => (\r\n  <AccordionPrimitive.Content\r\n    ref={ref}\r\n    className=\"overflow-hidden text-sm data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down\"\r\n    {...props}>\r\n    <div className={cn(\"pb-4 pt-0\", className)}>{children}</div>\r\n  </AccordionPrimitive.Content>\r\n))\r\nAccordionContent.displayName = AccordionPrimitive.Content.displayName\r\n\r\nexport { Accordion, AccordionItem, AccordionTrigger, AccordionContent }\r\n"],"names":[],"mappings":";;;;;;;AAEA;AAIA;AAHA;AACA;AAJA;;;;;;AAQA,MAAM,YAAY,yKAAmB,IAAI;AAEzC,MAAM,8BAAgB,8JAAM,UAAU,MAAC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC/D,6LAAC,yKAAmB,IAAI;QAAC,KAAK;QAAK,WAAW,CAAA,GAAA,+GAAA,CAAA,KAAE,AAAD,EAAE,YAAY;QAAa,GAAG,KAAK;;;;;;;AAEpF,cAAc,WAAW,GAAG;AAE5B,MAAM,iCAAmB,8JAAM,UAAU,OAAC,CAAC,EAAE,SAAS,EAAE,QAAQ,EAAE,GAAG,OAAO,EAAE,oBAC5E,6LAAC,yKAAmB,MAAM;QAAC,WAAU;kBACnC,cAAA,6LAAC,yKAAmB,OAAO;YACzB,KAAK;YACL,WAAW,CAAA,GAAA,+GAAA,CAAA,KAAE,AAAD,EACV,kJACA;YAED,GAAG,KAAK;;gBACR;8BACD,6LAAC,uNAAA,CAAA,cAAW;oBACV,WAAU;;;;;;;;;;;;;;;;;;AAIlB,iBAAiB,WAAW,GAAG,yKAAmB,OAAO,CAAC,WAAW;AAErE,MAAM,iCAAmB,8JAAM,UAAU,OAAC,CAAC,EAAE,SAAS,EAAE,QAAQ,EAAE,GAAG,OAAO,EAAE,oBAC5E,6LAAC,yKAAmB,OAAO;QACzB,KAAK;QACL,WAAU;QACT,GAAG,KAAK;kBACT,cAAA,6LAAC;YAAI,WAAW,CAAA,GAAA,+GAAA,CAAA,KAAE,AAAD,EAAE,aAAa;sBAAa;;;;;;;;;;;;AAGjD,iBAAiB,WAAW,GAAG,yKAAmB,OAAO,CAAC,WAAW"}},
    {"offset": {"line": 113, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 119, "column": 0}, "map": {"version":3,"sources":["file://E%3A/Car7/components/ui/button.jsx"],"sourcesContent":["import * as React from \"react\"\r\nimport { Slot } from \"@radix-ui/react-slot\"\r\nimport { cva } from \"class-variance-authority\";\r\n\r\nimport { cn } from \"@/lib/utils\"\r\n\r\nconst buttonVariants = cva(\r\n  \"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\r\n  {\r\n    variants: {\r\n      variant: {\r\n        default:\r\n          \"bg-primary text-primary-foreground shadow hover:bg-primary/90\",\r\n        destructive:\r\n          \"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90\",\r\n        outline:\r\n          \"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground\",\r\n        secondary:\r\n          \"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80\",\r\n        ghost: \"hover:bg-accent hover:text-accent-foreground\",\r\n        link: \"text-primary underline-offset-4 hover:underline\",\r\n      },\r\n      size: {\r\n        default: \"h-9 px-4 py-2\",\r\n        sm: \"h-8 rounded-md px-3 text-xs\",\r\n        lg: \"h-10 rounded-md px-8\",\r\n        icon: \"h-9 w-9\",\r\n      },\r\n    },\r\n    defaultVariants: {\r\n      variant: \"default\",\r\n      size: \"default\",\r\n    },\r\n  }\r\n)\r\n\r\nconst Button = React.forwardRef(({ className, variant, size, asChild = false, ...props }, ref) => {\r\n  const Comp = asChild ? Slot : \"button\"\r\n  return (\r\n    (<Comp\r\n      className={cn(buttonVariants({ variant, size, className }))}\r\n      ref={ref}\r\n      {...props} />)\r\n  );\r\n})\r\nButton.displayName = \"Button\"\r\n\r\nexport { Button, buttonVariants }\r\n"],"names":[],"mappings":";;;;;AAAA;AAEA;AAEA;AAHA;;;;;;AAKA,MAAM,iBAAiB,CAAA,GAAA,mKAAA,CAAA,MAAG,AAAD,EACvB,ySACA;IACE,UAAU;QACR,SAAS;YACP,SACE;YACF,aACE;YACF,SACE;YACF,WACE;YACF,OAAO;YACP,MAAM;QACR;QACA,MAAM;YACJ,SAAS;YACT,IAAI;YACJ,IAAI;YACJ,MAAM;QACR;IACF;IACA,iBAAiB;QACf,SAAS;QACT,MAAM;IACR;AACF;AAGF,MAAM,uBAAS,8JAAM,UAAU,MAAC,CAAC,EAAE,SAAS,EAAE,OAAO,EAAE,IAAI,EAAE,UAAU,KAAK,EAAE,GAAG,OAAO,EAAE;IACxF,MAAM,OAAO,UAAU,mKAAA,CAAA,OAAI,GAAG;IAC9B,qBACG,6LAAC;QACA,WAAW,CAAA,GAAA,+GAAA,CAAA,KAAE,AAAD,EAAE,eAAe;YAAE;YAAS;YAAM;QAAU;QACxD,KAAK;QACJ,GAAG,KAAK;;;;;;AAEf;;AACA,OAAO,WAAW,GAAG"}},
    {"offset": {"line": 180, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 186, "column": 0}, "map": {"version":3,"sources":["file://E%3A/Car7/components/ui/card.jsx"],"sourcesContent":["import * as React from \"react\"\r\n\r\nimport { cn } from \"@/lib/utils\"\r\n\r\nconst Card = React.forwardRef(({ className, ...props }, ref) => (\r\n  <div\r\n    ref={ref}\r\n    className={cn(\"rounded-xl border bg-card text-card-foreground shadow\", className)}\r\n    {...props} />\r\n))\r\nCard.displayName = \"Card\"\r\n\r\nconst CardHeader = React.forwardRef(({ className, ...props }, ref) => (\r\n  <div\r\n    ref={ref}\r\n    className={cn(\"flex flex-col space-y-1.5 p-6\", className)}\r\n    {...props} />\r\n))\r\nCardHeader.displayName = \"CardHeader\"\r\n\r\nconst CardTitle = React.forwardRef(({ className, ...props }, ref) => (\r\n  <div\r\n    ref={ref}\r\n    className={cn(\"font-semibold leading-none tracking-tight\", className)}\r\n    {...props} />\r\n))\r\nCardTitle.displayName = \"CardTitle\"\r\n\r\nconst CardDescription = React.forwardRef(({ className, ...props }, ref) => (\r\n  <div\r\n    ref={ref}\r\n    className={cn(\"text-sm text-muted-foreground\", className)}\r\n    {...props} />\r\n))\r\nCardDescription.displayName = \"CardDescription\"\r\n\r\nconst CardContent = React.forwardRef(({ className, ...props }, ref) => (\r\n  <div ref={ref} className={cn(\"p-6 pt-0\", className)} {...props} />\r\n))\r\nCardContent.displayName = \"CardContent\"\r\n\r\nconst CardFooter = React.forwardRef(({ className, ...props }, ref) => (\r\n  <div\r\n    ref={ref}\r\n    className={cn(\"flex items-center p-6 pt-0\", className)}\r\n    {...props} />\r\n))\r\nCardFooter.displayName = \"CardFooter\"\r\n\r\nexport { Card, CardHeader, CardFooter, CardTitle, CardDescription, CardContent }\r\n"],"names":[],"mappings":";;;;;;;;;AAAA;AAEA;;;;AAEA,MAAM,qBAAO,8JAAM,UAAU,MAAC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBACtD,6LAAC;QACC,KAAK;QACL,WAAW,CAAA,GAAA,+GAAA,CAAA,KAAE,AAAD,EAAE,yDAAyD;QACtE,GAAG,KAAK;;;;;;;AAEb,KAAK,WAAW,GAAG;AAEnB,MAAM,2BAAa,8JAAM,UAAU,OAAC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC5D,6LAAC;QACC,KAAK;QACL,WAAW,CAAA,GAAA,+GAAA,CAAA,KAAE,AAAD,EAAE,iCAAiC;QAC9C,GAAG,KAAK;;;;;;;AAEb,WAAW,WAAW,GAAG;AAEzB,MAAM,0BAAY,8JAAM,UAAU,OAAC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC3D,6LAAC;QACC,KAAK;QACL,WAAW,CAAA,GAAA,+GAAA,CAAA,KAAE,AAAD,EAAE,6CAA6C;QAC1D,GAAG,KAAK;;;;;;;AAEb,UAAU,WAAW,GAAG;AAExB,MAAM,gCAAkB,8JAAM,UAAU,OAAC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBACjE,6LAAC;QACC,KAAK;QACL,WAAW,CAAA,GAAA,+GAAA,CAAA,KAAE,AAAD,EAAE,iCAAiC;QAC9C,GAAG,KAAK;;;;;;;AAEb,gBAAgB,WAAW,GAAG;AAE9B,MAAM,4BAAc,8JAAM,UAAU,OAAC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC7D,6LAAC;QAAI,KAAK;QAAK,WAAW,CAAA,GAAA,+GAAA,CAAA,KAAE,AAAD,EAAE,YAAY;QAAa,GAAG,KAAK;;;;;;;AAEhE,YAAY,WAAW,GAAG;AAE1B,MAAM,2BAAa,8JAAM,UAAU,QAAC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC5D,6LAAC;QACC,KAAK;QACL,WAAW,CAAA,GAAA,+GAAA,CAAA,KAAE,AAAD,EAAE,8BAA8B;QAC3C,GAAG,KAAK;;;;;;;AAEb,WAAW,WAAW,GAAG"}},
    {"offset": {"line": 283, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 289, "column": 0}, "map": {"version":3,"sources":["file://E%3A/Car7/components/ui/badge.jsx"],"sourcesContent":["import * as React from \"react\"\r\nimport { cva } from \"class-variance-authority\";\r\n\r\nimport { cn } from \"@/lib/utils\"\r\n\r\nconst badgeVariants = cva(\r\n  \"inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2\",\r\n  {\r\n    variants: {\r\n      variant: {\r\n        default:\r\n          \"border-transparent bg-primary text-primary-foreground shadow hover:bg-primary/80\",\r\n        secondary:\r\n          \"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80\",\r\n        destructive:\r\n          \"border-transparent bg-destructive text-destructive-foreground shadow hover:bg-destructive/80\",\r\n        outline: \"text-foreground\",\r\n      },\r\n    },\r\n    defaultVariants: {\r\n      variant: \"default\",\r\n    },\r\n  }\r\n)\r\n\r\nfunction Badge({\r\n  className,\r\n  variant,\r\n  ...props\r\n}) {\r\n  return (<div className={cn(badgeVariants({ variant }), className)} {...props} />);\r\n}\r\n\r\nexport { Badge, badgeVariants }\r\n"],"names":[],"mappings":";;;;;AAAA;AACA;AAEA;;;;;AAEA,MAAM,gBAAgB,CAAA,GAAA,mKAAA,CAAA,MAAG,AAAD,EACtB,wKACA;IACE,UAAU;QACR,SAAS;YACP,SACE;YACF,WACE;YACF,aACE;YACF,SAAS;QACX;IACF;IACA,iBAAiB;QACf,SAAS;IACX;AACF;AAGF,SAAS,MAAM,EACb,SAAS,EACT,OAAO,EACP,GAAG,OACJ;IACC,qBAAQ,6LAAC;QAAI,WAAW,CAAA,GAAA,+GAAA,CAAA,KAAE,AAAD,EAAE,cAAc;YAAE;QAAQ,IAAI;QAAa,GAAG,KAAK;;;;;;AAC9E;KANS"}},
    {"offset": {"line": 333, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 339, "column": 0}, "map": {"version":3,"sources":["file://E%3A/Car7/actions/car-listing.js"],"sourcesContent":["\"use server\";\r\n\r\nimport { serializeCarData } from \"@/lib/helpers\";\r\nimport { db } from \"@/lib/prisma\";\r\nimport { auth } from \"@clerk/nextjs/server\";\r\nimport { revalidatePath } from \"next/cache\";\r\n\r\n/**\r\n * Get simplified filters for the car marketplace\r\n */\r\nexport async function getCarFilters() {\r\n  try {\r\n    // Get unique makes\r\n    const makes = await db.car.findMany({\r\n      where: { status: \"AVAILABLE\" },\r\n      select: { make: true },\r\n      distinct: [\"make\"],\r\n      orderBy: { make: \"asc\" },\r\n    });\r\n\r\n    // Get unique body types\r\n    const bodyTypes = await db.car.findMany({\r\n      where: { status: \"AVAILABLE\" },\r\n      select: { bodyType: true },\r\n      distinct: [\"bodyType\"],\r\n      orderBy: { bodyType: \"asc\" },\r\n    });\r\n\r\n    // Get unique fuel types\r\n    const fuelTypes = await db.car.findMany({\r\n      where: { status: \"AVAILABLE\" },\r\n      select: { fuelType: true },\r\n      distinct: [\"fuelType\"],\r\n      orderBy: { fuelType: \"asc\" },\r\n    });\r\n\r\n    // Get unique transmissions\r\n    const transmissions = await db.car.findMany({\r\n      where: { status: \"AVAILABLE\" },\r\n      select: { transmission: true },\r\n      distinct: [\"transmission\"],\r\n      orderBy: { transmission: \"asc\" },\r\n    });\r\n\r\n    // Get min and max prices using Prisma aggregations\r\n    const priceAggregations = await db.car.aggregate({\r\n      where: { status: \"AVAILABLE\" },\r\n      _min: { price: true },\r\n      _max: { price: true },\r\n    });\r\n\r\n    return {\r\n      success: true,\r\n      data: {\r\n        makes: makes.map((item) => item.make),\r\n        bodyTypes: bodyTypes.map((item) => item.bodyType),\r\n        fuelTypes: fuelTypes.map((item) => item.fuelType),\r\n        transmissions: transmissions.map((item) => item.transmission),\r\n        priceRange: {\r\n          min: priceAggregations._min.price\r\n            ? parseFloat(priceAggregations._min.price.toString())\r\n            : 0,\r\n          max: priceAggregations._max.price\r\n            ? parseFloat(priceAggregations._max.price.toString())\r\n            : 100000,\r\n        },\r\n      },\r\n    };\r\n  } catch (error) {\r\n    throw new Error(\"Error fetching car filters:\" + error.message);\r\n  }\r\n}\r\n\r\n/**\r\n * Get cars with simplified filters\r\n */\r\nexport async function getCars({\r\n  search = \"\",\r\n  make = \"\",\r\n  bodyType = \"\",\r\n  fuelType = \"\",\r\n  transmission = \"\",\r\n  minPrice = 0,\r\n  maxPrice = Number.MAX_SAFE_INTEGER,\r\n  sortBy = \"newest\", // Options: newest, priceAsc, priceDesc\r\n  page = 1,\r\n  limit = 6,\r\n}) {\r\n  try {\r\n    // Get current user if authenticated\r\n    const { userId } = await auth();\r\n    let dbUser = null;\r\n\r\n    if (userId) {\r\n      dbUser = await db.user.findUnique({\r\n        where: { clerkUserId: userId },\r\n      });\r\n    }\r\n\r\n    // Build where conditions\r\n    let where = {\r\n      status: \"AVAILABLE\",\r\n    };\r\n\r\n    if (search) {\r\n      where.OR = [\r\n        { make: { contains: search, mode: \"insensitive\" } },\r\n        { model: { contains: search, mode: \"insensitive\" } },\r\n        { description: { contains: search, mode: \"insensitive\" } },\r\n      ];\r\n    }\r\n\r\n    if (make) where.make = { equals: make, mode: \"insensitive\" };\r\n    if (bodyType) where.bodyType = { equals: bodyType, mode: \"insensitive\" };\r\n    if (fuelType) where.fuelType = { equals: fuelType, mode: \"insensitive\" };\r\n    if (transmission)\r\n      where.transmission = { equals: transmission, mode: \"insensitive\" };\r\n\r\n    // Add price range\r\n    where.price = {\r\n      gte: parseFloat(minPrice) || 0,\r\n    };\r\n\r\n    if (maxPrice && maxPrice < Number.MAX_SAFE_INTEGER) {\r\n      where.price.lte = parseFloat(maxPrice);\r\n    }\r\n\r\n    // Calculate pagination\r\n    const skip = (page - 1) * limit;\r\n\r\n    // Determine sort order\r\n    let orderBy = {};\r\n    switch (sortBy) {\r\n      case \"priceAsc\":\r\n        orderBy = { price: \"asc\" };\r\n        break;\r\n      case \"priceDesc\":\r\n        orderBy = { price: \"desc\" };\r\n        break;\r\n      case \"newest\":\r\n      default:\r\n        orderBy = { createdAt: \"desc\" };\r\n        break;\r\n    }\r\n\r\n    // Get total count for pagination\r\n    const totalCars = await db.car.count({ where });\r\n\r\n    // Execute the main query\r\n    const cars = await db.car.findMany({\r\n      where,\r\n      take: limit,\r\n      skip,\r\n      orderBy,\r\n    });\r\n\r\n    // If we have a user, check which cars are wishlisted\r\n    let wishlisted = new Set();\r\n    if (dbUser) {\r\n      const savedCars = await db.userSavedCar.findMany({\r\n        where: { userId: dbUser.id },\r\n        select: { carId: true },\r\n      });\r\n\r\n      wishlisted = new Set(savedCars.map((saved) => saved.carId));\r\n    }\r\n\r\n    // Serialize and check wishlist status\r\n    const serializedCars = cars.map((car) =>\r\n      serializeCarData(car, wishlisted.has(car.id))\r\n    );\r\n\r\n    return {\r\n      success: true,\r\n      data: serializedCars,\r\n      pagination: {\r\n        total: totalCars,\r\n        page,\r\n        limit,\r\n        pages: Math.ceil(totalCars / limit),\r\n      },\r\n    };\r\n  } catch (error) {\r\n    throw new Error(\"Error fetching cars:\" + error.message);\r\n  }\r\n}\r\n\r\n/**\r\n * Toggle car in user's wishlist\r\n */\r\nexport async function toggleSavedCar(carId) {\r\n  try {\r\n    const { userId } = await auth();\r\n    if (!userId) throw new Error(\"Unauthorized\");\r\n\r\n    const user = await db.user.findUnique({\r\n      where: { clerkUserId: userId },\r\n    });\r\n\r\n    if (!user) throw new Error(\"User not found\");\r\n\r\n    // Check if car exists\r\n    const car = await db.car.findUnique({\r\n      where: { id: carId },\r\n    });\r\n\r\n    if (!car) {\r\n      return {\r\n        success: false,\r\n        error: \"Car not found\",\r\n      };\r\n    }\r\n\r\n    // Check if car is already saved\r\n    const existingSave = await db.userSavedCar.findUnique({\r\n      where: {\r\n        userId_carId: {\r\n          userId: user.id,\r\n          carId,\r\n        },\r\n      },\r\n    });\r\n\r\n    // If car is already saved, remove it\r\n    if (existingSave) {\r\n      await db.userSavedCar.delete({\r\n        where: {\r\n          userId_carId: {\r\n            userId: user.id,\r\n            carId,\r\n          },\r\n        },\r\n      });\r\n\r\n      revalidatePath(`/saved-cars`);\r\n      return {\r\n        success: true,\r\n        saved: false,\r\n        message: \"Car removed from favorites\",\r\n      };\r\n    }\r\n\r\n    // If car is not saved, add it\r\n    await db.userSavedCar.create({\r\n      data: {\r\n        userId: user.id,\r\n        carId,\r\n      },\r\n    });\r\n\r\n    revalidatePath(`/saved-cars`);\r\n    return {\r\n      success: true,\r\n      saved: true,\r\n      message: \"Car added to favorites\",\r\n    };\r\n  } catch (error) {\r\n    throw new Error(\"Error toggling saved car:\" + error.message);\r\n  }\r\n}\r\n\r\n/**\r\n * Get car details by ID\r\n */\r\nexport async function getCarById(carId) {\r\n  try {\r\n    // Get current user if authenticated\r\n    const { userId } = await auth();\r\n    let dbUser = null;\r\n\r\n    if (userId) {\r\n      dbUser = await db.user.findUnique({\r\n        where: { clerkUserId: userId },\r\n      });\r\n    }\r\n\r\n    // Get car details\r\n    const car = await db.car.findUnique({\r\n      where: { id: carId },\r\n    });\r\n\r\n    if (!car) {\r\n      return {\r\n        success: false,\r\n        error: \"Car not found\",\r\n      };\r\n    }\r\n\r\n    // Check if car is wishlisted by user\r\n    let isWishlisted = false;\r\n    if (dbUser) {\r\n      const savedCar = await db.userSavedCar.findUnique({\r\n        where: {\r\n          userId_carId: {\r\n            userId: dbUser.id,\r\n            carId,\r\n          },\r\n        },\r\n      });\r\n\r\n      isWishlisted = !!savedCar;\r\n    }\r\n\r\n    // Check if user has already booked a test drive for this car\r\n    const existingTestDrive = await db.testDriveBooking.findFirst({\r\n      where: {\r\n        carId,\r\n        userId: dbUser.id,\r\n        status: { in: [\"PENDING\", \"CONFIRMED\", \"COMPLETED\"] },\r\n      },\r\n      orderBy: {\r\n        createdAt: \"desc\",\r\n      },\r\n    });\r\n\r\n    let userTestDrive = null;\r\n\r\n    if (existingTestDrive) {\r\n      userTestDrive = {\r\n        id: existingTestDrive.id,\r\n        status: existingTestDrive.status,\r\n        bookingDate: existingTestDrive.bookingDate.toISOString(),\r\n      };\r\n    }\r\n\r\n    // Get dealership info for test drive availability\r\n    const dealership = await db.dealershipInfo.findFirst({\r\n      include: {\r\n        workingHours: true,\r\n      },\r\n    });\r\n\r\n    return {\r\n      success: true,\r\n      data: {\r\n        ...serializeCarData(car, isWishlisted),\r\n        testDriveInfo: {\r\n          userTestDrive,\r\n          dealership: dealership\r\n            ? {\r\n                ...dealership,\r\n                createdAt: dealership.createdAt.toISOString(),\r\n                updatedAt: dealership.updatedAt.toISOString(),\r\n                workingHours: dealership.workingHours.map((hour) => ({\r\n                  ...hour,\r\n                  createdAt: hour.createdAt.toISOString(),\r\n                  updatedAt: hour.updatedAt.toISOString(),\r\n                })),\r\n              }\r\n            : null,\r\n        },\r\n      },\r\n    };\r\n  } catch (error) {\r\n    throw new Error(\"Error fetching car details:\" + error.message);\r\n  }\r\n}\r\n\r\n/**\r\n * Get user's saved cars\r\n */\r\nexport async function getSavedCars() {\r\n  try {\r\n    const { userId } = await auth();\r\n    if (!userId) {\r\n      return {\r\n        success: false,\r\n        error: \"Unauthorized\",\r\n      };\r\n    }\r\n\r\n    // Get the user from our database\r\n    const user = await db.user.findUnique({\r\n      where: { clerkUserId: userId },\r\n    });\r\n\r\n    if (!user) {\r\n      return {\r\n        success: false,\r\n        error: \"User not found\",\r\n      };\r\n    }\r\n\r\n    // Get saved cars with their details\r\n    const savedCars = await db.userSavedCar.findMany({\r\n      where: { userId: user.id },\r\n      include: {\r\n        car: true,\r\n      },\r\n      orderBy: { savedAt: \"desc\" },\r\n    });\r\n\r\n    // Extract and format car data\r\n    const cars = savedCars.map((saved) => serializeCarData(saved.car));\r\n\r\n    return {\r\n      success: true,\r\n      data: cars,\r\n    };\r\n  } catch (error) {\r\n    console.error(\"Error fetching saved cars:\", error);\r\n    return {\r\n      success: false,\r\n      error: error.message,\r\n    };\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;;;;;;;IAUsB;IAkEA;IAkHA;IA0EA;IAiGA"}},
    {"offset": {"line": 353, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 359, "column": 0}, "map": {"version":3,"sources":["file://E%3A/Car7/hooks/use-fetch.js"],"sourcesContent":["import { useState } from \"react\";\r\nimport { toast } from \"sonner\";\r\n\r\nconst useFetch = (cb) => {\r\n  const [data, setData] = useState(undefined);\r\n  const [loading, setLoading] = useState(null);\r\n  const [error, setError] = useState(null);\r\n\r\n  const fn = async (...args) => {\r\n    setLoading(true);\r\n    setError(null);\r\n\r\n    try {\r\n      const response = await cb(...args);\r\n      setData(response);\r\n      setError(null);\r\n    } catch (error) {\r\n      setError(error);\r\n      toast.error(error.message);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  return { data, loading, error, fn, setData };\r\n};\r\n\r\nexport default useFetch;\r\n"],"names":[],"mappings":";;;AAAA;AACA;;;;AAEA,MAAM,WAAW,CAAC;;IAChB,MAAM,CAAC,MAAM,QAAQ,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE;IACjC,MAAM,CAAC,SAAS,WAAW,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE;IACvC,MAAM,CAAC,OAAO,SAAS,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE;IAEnC,MAAM,KAAK,OAAO,GAAG;QACnB,WAAW;QACX,SAAS;QAET,IAAI;YACF,MAAM,WAAW,MAAM,MAAM;YAC7B,QAAQ;YACR,SAAS;QACX,EAAE,OAAO,OAAO;YACd,SAAS;YACT,2IAAA,CAAA,QAAK,CAAC,KAAK,CAAC,MAAM,OAAO;QAC3B,SAAU;YACR,WAAW;QACb;IACF;IAEA,OAAO;QAAE;QAAM;QAAS;QAAO;QAAI;IAAQ;AAC7C;GAtBM;uCAwBS"}},
    {"offset": {"line": 399, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 405, "column": 0}, "map": {"version":3,"sources":["file://E%3A/Car7/components/car-card.jsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useState, useEffect } from \"react\";\r\nimport Link from \"next/link\";\r\nimport Image from \"next/image\";\r\nimport { Heart, Car as CarIcon, Loader2 } from \"lucide-react\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Card, CardContent } from \"@/components/ui/card\";\r\nimport { Badge } from \"@/components/ui/badge\";\r\nimport { toast } from \"sonner\";\r\nimport { toggleSavedCar } from \"@/actions/car-listing\";\r\nimport { useAuth } from \"@clerk/nextjs\";\r\nimport { useRouter } from \"next/navigation\";\r\nimport useFetch from \"@/hooks/use-fetch\";\r\n\r\nexport const CarCard = ({ car }) => {\r\n  const { isSignedIn } = useAuth();\r\n  const router = useRouter();\r\n  const [isSaved, setIsSaved] = useState(car.wishlisted);\r\n\r\n  // Use the useFetch hook\r\n  const {\r\n    loading: isToggling,\r\n    fn: toggleSavedCarFn,\r\n    data: toggleResult,\r\n    error: toggleError,\r\n  } = useFetch(toggleSavedCar);\r\n\r\n  // Handle toggle result with useEffect\r\n  useEffect(() => {\r\n    if (toggleResult?.success && toggleResult.saved !== isSaved) {\r\n      setIsSaved(toggleResult.saved);\r\n      toast.success(toggleResult.message);\r\n    }\r\n  }, [toggleResult, isSaved]);\r\n\r\n  // Handle errors with useEffect\r\n  useEffect(() => {\r\n    if (toggleError) {\r\n      toast.error(\"Failed to update favorites\");\r\n    }\r\n  }, [toggleError]);\r\n\r\n  // Handle save/unsave car\r\n  const handleToggleSave = async (e) => {\r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n\r\n    if (!isSignedIn) {\r\n      toast.error(\"Please sign in to save cars\");\r\n      router.push(\"/sign-in\");\r\n      return;\r\n    }\r\n\r\n    if (isToggling) return;\r\n\r\n    // Call the toggleSavedCar function using our useFetch hook\r\n    await toggleSavedCarFn(car.id);\r\n  };\r\n\r\n  return (\r\n    <Card className=\"overflow-hidden hover:shadow-lg transition group\">\r\n      <div className=\"relative h-48\">\r\n        {car.images && car.images.length > 0 ? (\r\n          <div className=\"relative w-full h-full\">\r\n            <Image\r\n              src={car.images[0]}\r\n              alt={`${car.make} ${car.model}`}\r\n              fill\r\n              className=\"object-cover group-hover:scale-105 transition duration-300\"\r\n            />\r\n          </div>\r\n        ) : (\r\n          <div className=\"w-full h-full bg-gray-200 flex items-center justify-center\">\r\n            <CarIcon className=\"h-12 w-12 text-gray-400\" />\r\n          </div>\r\n        )}\r\n\r\n        <Button\r\n          variant=\"ghost\"\r\n          size=\"icon\"\r\n          className={`absolute top-2 right-2 bg-white/90 rounded-full p-1.5 ${\r\n            isSaved\r\n              ? \"text-red-500 hover:text-red-600\"\r\n              : \"text-gray-600 hover:text-gray-900\"\r\n          }`}\r\n          onClick={handleToggleSave}\r\n          disabled={isToggling}\r\n        >\r\n          {isToggling ? (\r\n            <Loader2 className=\"h-4 w-4 animate-spin\" />\r\n          ) : (\r\n            <Heart className={isSaved ? \"fill-current\" : \"\"} size={20} />\r\n          )}\r\n        </Button>\r\n      </div>\r\n\r\n      <CardContent className=\"p-4\">\r\n        <div className=\"flex flex-col mb-2\">\r\n          <h3 className=\"text-lg font-bold line-clamp-1\">\r\n            {car.make} {car.model}\r\n          </h3>\r\n          <span className=\"text-xl font-bold text-blue-600\">\r\n            ${car.price.toLocaleString()}\r\n          </span>\r\n        </div>\r\n\r\n        <div className=\"text-gray-600 mb-2 flex items-center\">\r\n          <span>{car.year}</span>\r\n          <span className=\"mx-2\">•</span>\r\n          <span>{car.transmission}</span>\r\n          <span className=\"mx-2\">•</span>\r\n          <span>{car.fuelType}</span>\r\n        </div>\r\n\r\n        <div className=\"flex flex-wrap gap-1 mb-4\">\r\n          <Badge variant=\"outline\" className=\"bg-gray-50\">\r\n            {car.bodyType}\r\n          </Badge>\r\n          <Badge variant=\"outline\" className=\"bg-gray-50\">\r\n            {car.mileage.toLocaleString()} miles\r\n          </Badge>\r\n          <Badge variant=\"outline\" className=\"bg-gray-50\">\r\n            {car.color}\r\n          </Badge>\r\n        </div>\r\n\r\n        <div className=\"flex justify-between\">\r\n          <Button\r\n            className=\"flex-1\"\r\n            onClick={() => {\r\n              router.push(`/cars/${car.id}`);\r\n            }}\r\n          >\r\n            View Car\r\n          </Button>\r\n        </div>\r\n      </CardContent>\r\n    </Card>\r\n  );\r\n};\r\n"],"names":[],"mappings":";;;;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AAFA;AANA;AAAA;AAAA;;;AALA;;;;;;;;;;;;;AAeO,MAAM,UAAU,CAAC,EAAE,GAAG,EAAE;;IAC7B,MAAM,EAAE,UAAU,EAAE,GAAG,CAAA,GAAA,qPAAA,CAAA,UAAO,AAAD;IAC7B,MAAM,SAAS,CAAA,GAAA,qIAAA,CAAA,YAAS,AAAD;IACvB,MAAM,CAAC,SAAS,WAAW,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE,IAAI,UAAU;IAErD,wBAAwB;IACxB,MAAM,EACJ,SAAS,UAAU,EACnB,IAAI,gBAAgB,EACpB,MAAM,YAAY,EAClB,OAAO,WAAW,EACnB,GAAG,CAAA,GAAA,wHAAA,CAAA,UAAQ,AAAD,EAAE,4HAAA,CAAA,iBAAc;IAE3B,sCAAsC;IACtC,CAAA,GAAA,6JAAA,CAAA,YAAS,AAAD;6BAAE;YACR,IAAI,cAAc,WAAW,aAAa,KAAK,KAAK,SAAS;gBAC3D,WAAW,aAAa,KAAK;gBAC7B,2IAAA,CAAA,QAAK,CAAC,OAAO,CAAC,aAAa,OAAO;YACpC;QACF;4BAAG;QAAC;QAAc;KAAQ;IAE1B,+BAA+B;IAC/B,CAAA,GAAA,6JAAA,CAAA,YAAS,AAAD;6BAAE;YACR,IAAI,aAAa;gBACf,2IAAA,CAAA,QAAK,CAAC,KAAK,CAAC;YACd;QACF;4BAAG;QAAC;KAAY;IAEhB,yBAAyB;IACzB,MAAM,mBAAmB,OAAO;QAC9B,EAAE,cAAc;QAChB,EAAE,eAAe;QAEjB,IAAI,CAAC,YAAY;YACf,2IAAA,CAAA,QAAK,CAAC,KAAK,CAAC;YACZ,OAAO,IAAI,CAAC;YACZ;QACF;QAEA,IAAI,YAAY;QAEhB,2DAA2D;QAC3D,MAAM,iBAAiB,IAAI,EAAE;IAC/B;IAEA,qBACE,6LAAC,4HAAA,CAAA,OAAI;QAAC,WAAU;;0BACd,6LAAC;gBAAI,WAAU;;oBACZ,IAAI,MAAM,IAAI,IAAI,MAAM,CAAC,MAAM,GAAG,kBACjC,6LAAC;wBAAI,WAAU;kCACb,cAAA,6LAAC,gIAAA,CAAA,UAAK;4BACJ,KAAK,IAAI,MAAM,CAAC,EAAE;4BAClB,KAAK,GAAG,IAAI,IAAI,CAAC,CAAC,EAAE,IAAI,KAAK,EAAE;4BAC/B,IAAI;4BACJ,WAAU;;;;;;;;;;6CAId,6LAAC;wBAAI,WAAU;kCACb,cAAA,6LAAC,mMAAA,CAAA,MAAO;4BAAC,WAAU;;;;;;;;;;;kCAIvB,6LAAC,8HAAA,CAAA,SAAM;wBACL,SAAQ;wBACR,MAAK;wBACL,WAAW,CAAC,sDAAsD,EAChE,UACI,oCACA,qCACJ;wBACF,SAAS;wBACT,UAAU;kCAET,2BACC,6LAAC,oNAAA,CAAA,UAAO;4BAAC,WAAU;;;;;iDAEnB,6LAAC,uMAAA,CAAA,QAAK;4BAAC,WAAW,UAAU,iBAAiB;4BAAI,MAAM;;;;;;;;;;;;;;;;;0BAK7D,6LAAC,4HAAA,CAAA,cAAW;gBAAC,WAAU;;kCACrB,6LAAC;wBAAI,WAAU;;0CACb,6LAAC;gCAAG,WAAU;;oCACX,IAAI,IAAI;oCAAC;oCAAE,IAAI,KAAK;;;;;;;0CAEvB,6LAAC;gCAAK,WAAU;;oCAAkC;oCAC9C,IAAI,KAAK,CAAC,cAAc;;;;;;;;;;;;;kCAI9B,6LAAC;wBAAI,WAAU;;0CACb,6LAAC;0CAAM,IAAI,IAAI;;;;;;0CACf,6LAAC;gCAAK,WAAU;0CAAO;;;;;;0CACvB,6LAAC;0CAAM,IAAI,YAAY;;;;;;0CACvB,6LAAC;gCAAK,WAAU;0CAAO;;;;;;0CACvB,6LAAC;0CAAM,IAAI,QAAQ;;;;;;;;;;;;kCAGrB,6LAAC;wBAAI,WAAU;;0CACb,6LAAC,6HAAA,CAAA,QAAK;gCAAC,SAAQ;gCAAU,WAAU;0CAChC,IAAI,QAAQ;;;;;;0CAEf,6LAAC,6HAAA,CAAA,QAAK;gCAAC,SAAQ;gCAAU,WAAU;;oCAChC,IAAI,OAAO,CAAC,cAAc;oCAAG;;;;;;;0CAEhC,6LAAC,6HAAA,CAAA,QAAK;gCAAC,SAAQ;gCAAU,WAAU;0CAChC,IAAI,KAAK;;;;;;;;;;;;kCAId,6LAAC;wBAAI,WAAU;kCACb,cAAA,6LAAC,8HAAA,CAAA,SAAM;4BACL,WAAU;4BACV,SAAS;gCACP,OAAO,IAAI,CAAC,CAAC,MAAM,EAAE,IAAI,EAAE,EAAE;4BAC/B;sCACD;;;;;;;;;;;;;;;;;;;;;;;AAOX;GA7Ha;;QACY,qPAAA,CAAA,UAAO;QACf,qIAAA,CAAA,YAAS;QASpB,wHAAA,CAAA,UAAQ;;;KAXD"}},
    {"offset": {"line": 711, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 717, "column": 0}, "map": {"version":3,"sources":["file://E%3A/Car7/components/ui/input.jsx"],"sourcesContent":["import * as React from \"react\"\r\n\r\nimport { cn } from \"@/lib/utils\"\r\n\r\nconst Input = React.forwardRef(({ className, type, ...props }, ref) => {\r\n  return (\r\n    (<input\r\n      type={type}\r\n      className={cn(\r\n        \"flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\r\n        className\r\n      )}\r\n      ref={ref}\r\n      {...props} />)\r\n  );\r\n})\r\nInput.displayName = \"Input\"\r\n\r\nexport { Input }\r\n"],"names":[],"mappings":";;;;AAAA;AAEA;;;;AAEA,MAAM,sBAAQ,8JAAM,UAAU,MAAC,CAAC,EAAE,SAAS,EAAE,IAAI,EAAE,GAAG,OAAO,EAAE;IAC7D,qBACG,6LAAC;QACA,MAAM;QACN,WAAW,CAAA,GAAA,+GAAA,CAAA,KAAE,AAAD,EACV,2WACA;QAEF,KAAK;QACJ,GAAG,KAAK;;;;;;AAEf;;AACA,MAAM,WAAW,GAAG"}},
    {"offset": {"line": 747, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 753, "column": 0}, "map": {"version":3,"sources":["file://E%3A/Car7/actions/home.js"],"sourcesContent":["\"use server\";\r\n\r\nimport { GoogleGenerativeAI } from \"@google/generative-ai\";\r\nimport { db } from \"@/lib/prisma\";\r\nimport aj from \"@/lib/arcjet\";\r\nimport { request } from \"@arcjet/next\";\r\n\r\n// Function to serialize car data\r\nfunction serializeCarData(car) {\r\n  return {\r\n    ...car,\r\n    price: car.price ? parseFloat(car.price.toString()) : 0,\r\n    createdAt: car.createdAt?.toISOString(),\r\n    updatedAt: car.updatedAt?.toISOString(),\r\n  };\r\n}\r\n\r\n/**\r\n * Get featured cars for the homepage\r\n */\r\nexport async function getFeaturedCars(limit = 3) {\r\n  try {\r\n    const cars = await db.car.findMany({\r\n      where: {\r\n        featured: true,\r\n        status: \"AVAILABLE\",\r\n      },\r\n      take: limit,\r\n      orderBy: { createdAt: \"desc\" },\r\n    });\r\n\r\n    return cars.map(serializeCarData);\r\n  } catch (error) {\r\n    throw new Error(\"Error fetching featured cars:\" + error.message);\r\n  }\r\n}\r\n\r\n// Function to convert File to base64\r\nasync function fileToBase64(file) {\r\n  const bytes = await file.arrayBuffer();\r\n  const buffer = Buffer.from(bytes);\r\n  return buffer.toString(\"base64\");\r\n}\r\n\r\n/**\r\n * Process car image with Gemini AI\r\n */\r\nexport async function processImageSearch(file) {\r\n  try {\r\n    // Get request data for ArcJet\r\n    const req = await request();\r\n\r\n    // Check rate limit\r\n    const decision = await aj.protect(req, {\r\n      requested: 1, // Specify how many tokens to consume\r\n    });\r\n\r\n    if (decision.isDenied()) {\r\n      if (decision.reason.isRateLimit()) {\r\n        const { remaining, reset } = decision.reason;\r\n        console.error({\r\n          code: \"RATE_LIMIT_EXCEEDED\",\r\n          details: {\r\n            remaining,\r\n            resetInSeconds: reset,\r\n          },\r\n        });\r\n\r\n        throw new Error(\"Too many requests. Please try again later.\");\r\n      }\r\n\r\n      throw new Error(\"Request blocked\");\r\n    }\r\n\r\n    // Check if API key is available\r\n    if (!process.env.GEMINI_API_KEY) {\r\n      throw new Error(\"Gemini API key is not configured\");\r\n    }\r\n\r\n    // Initialize Gemini API\r\n    const genAI = new GoogleGenerativeAI(process.env.GEMINI_API_KEY);\r\n    const model = genAI.getGenerativeModel({ model: \"gemini-1.5-flash\" });\r\n\r\n    // Convert image file to base64\r\n    const base64Image = await fileToBase64(file);\r\n\r\n    // Create image part for the model\r\n    const imagePart = {\r\n      inlineData: {\r\n        data: base64Image,\r\n        mimeType: file.type,\r\n      },\r\n    };\r\n\r\n    // Define the prompt for car search extraction\r\n    const prompt = `\r\n      Analyze this car image and extract the following information for a search query:\r\n      1. Make (manufacturer)\r\n      2. Body type (SUV, Sedan, Hatchback, etc.)\r\n      3. Color\r\n\r\n      Format your response as a clean JSON object with these fields:\r\n      {\r\n        \"make\": \"\",\r\n        \"bodyType\": \"\",\r\n        \"color\": \"\",\r\n        \"confidence\": 0.0\r\n      }\r\n\r\n      For confidence, provide a value between 0 and 1 representing how confident you are in your overall identification.\r\n      Only respond with the JSON object, nothing else.\r\n    `;\r\n\r\n    // Get response from Gemini\r\n    const result = await model.generateContent([imagePart, prompt]);\r\n    const response = await result.response;\r\n    const text = response.text();\r\n    const cleanedText = text.replace(/```(?:json)?\\n?/g, \"\").trim();\r\n\r\n    // Parse the JSON response\r\n    try {\r\n      const carDetails = JSON.parse(cleanedText);\r\n\r\n      // Return success response with data\r\n      return {\r\n        success: true,\r\n        data: carDetails,\r\n      };\r\n    } catch (parseError) {\r\n      console.error(\"Failed to parse AI response:\", parseError);\r\n      console.log(\"Raw response:\", text);\r\n      return {\r\n        success: false,\r\n        error: \"Failed to parse AI response\",\r\n      };\r\n    }\r\n  } catch (error) {\r\n    throw new Error(\"AI Search error:\" + error.message);\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;;;;IAoBsB;IA2BA"}},
    {"offset": {"line": 761, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 767, "column": 0}, "map": {"version":3,"sources":["file://E%3A/Car7/components/home-search.jsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useState, useEffect } from \"react\";\r\nimport { Search, Upload, Camera } from \"lucide-react\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Input } from \"@/components/ui/input\";\r\nimport { toast } from \"sonner\";\r\nimport { useDropzone } from \"react-dropzone\";\r\nimport { useRouter } from \"next/navigation\";\r\nimport { processImageSearch } from \"@/actions/home\";\r\nimport useFetch from \"@/hooks/use-fetch\";\r\n\r\nexport function HomeSearch() {\r\n  const router = useRouter();\r\n  const [searchTerm, setSearchTerm] = useState(\"\");\r\n  const [searchImage, setSearchImage] = useState(null);\r\n  const [imagePreview, setImagePreview] = useState(\"\");\r\n  const [isUploading, setIsUploading] = useState(false);\r\n  const [isImageSearchActive, setIsImageSearchActive] = useState(false);\r\n\r\n  // Use the useFetch hook for image processing\r\n  const {\r\n    loading: isProcessing,\r\n    fn: processImageFn,\r\n    data: processResult,\r\n    error: processError,\r\n  } = useFetch(processImageSearch);\r\n\r\n  // Handle process result and errors with useEffect\r\n  useEffect(() => {\r\n    if (processResult?.success) {\r\n      const params = new URLSearchParams();\r\n\r\n      // Add extracted params to the search\r\n      if (processResult.data.make) params.set(\"make\", processResult.data.make);\r\n      if (processResult.data.bodyType)\r\n        params.set(\"bodyType\", processResult.data.bodyType);\r\n      if (processResult.data.color)\r\n        params.set(\"color\", processResult.data.color);\r\n\r\n      // Redirect to search results\r\n      router.push(`/cars?${params.toString()}`);\r\n    }\r\n  }, [processResult, router]);\r\n\r\n  useEffect(() => {\r\n    if (processError) {\r\n      toast.error(\r\n        \"Failed to analyze image: \" + (processError.message || \"Unknown error\")\r\n      );\r\n    }\r\n  }, [processError]);\r\n\r\n  // Handle image upload with react-dropzone\r\n  const onDrop = (acceptedFiles) => {\r\n    const file = acceptedFiles[0];\r\n    if (file) {\r\n      if (file.size > 5 * 1024 * 1024) {\r\n        toast.error(\"Image size must be less than 5MB\");\r\n        return;\r\n      }\r\n\r\n      setIsUploading(true);\r\n      setSearchImage(file);\r\n\r\n      const reader = new FileReader();\r\n      reader.onloadend = () => {\r\n        setImagePreview(reader.result);\r\n        setIsUploading(false);\r\n        toast.success(\"Image uploaded successfully\");\r\n      };\r\n      reader.onerror = () => {\r\n        setIsUploading(false);\r\n        toast.error(\"Failed to read the image\");\r\n      };\r\n      reader.readAsDataURL(file);\r\n    }\r\n  };\r\n\r\n  const { getRootProps, getInputProps, isDragActive, isDragReject } =\r\n    useDropzone({\r\n      onDrop,\r\n      accept: {\r\n        \"image/*\": [\".jpeg\", \".jpg\", \".png\"],\r\n      },\r\n      maxFiles: 1,\r\n    });\r\n\r\n  // Handle text search submissions\r\n  const handleTextSearch = (e) => {\r\n    e.preventDefault();\r\n    if (!searchTerm.trim()) {\r\n      toast.error(\"Please enter a search term\");\r\n      return;\r\n    }\r\n\r\n    router.push(`/cars?search=${encodeURIComponent(searchTerm)}`);\r\n  };\r\n\r\n  // Handle image search submissions\r\n  const handleImageSearch = async (e) => {\r\n    e.preventDefault();\r\n    if (!searchImage) {\r\n      toast.error(\"Please upload an image first\");\r\n      return;\r\n    }\r\n\r\n    // Use the processImageFn from useFetch hook\r\n    await processImageFn(searchImage);\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      <form onSubmit={handleTextSearch}>\r\n        <div className=\"relative flex items-center\">\r\n          <Search className=\"absolute left-3 w-5 h-5\" />\r\n          <Input\r\n            type=\"text\"\r\n            placeholder=\"Enter make, model, or use our AI Image Search...\"\r\n            value={searchTerm}\r\n            onChange={(e) => setSearchTerm(e.target.value)}\r\n           className=\"pl-10 pr-12 py-6 w-full rounded-full bg-black/80 border border-[#00fff7] focus:outline-none text-[#00fff7] placeholder:text-gray-400\"\r\n          />\r\n\r\n          {/* Image Search Button */}\r\n          <div className=\"absolute right-[100px]\">\r\n            <Camera\r\n              size={35}\r\n              onClick={() => setIsImageSearchActive(!isImageSearchActive)}\r\n              className=\"cursor-pointer rounded-xl p-1.5\"\r\n              style={{\r\n                background: isImageSearchActive ? \"white\" : \"\",\r\n                color: isImageSearchActive ? \"black\" : \"\",\r\n              }}\r\n            />\r\n          </div>\r\n\r\n          <Button type=\"submit\" className=\"absolute right-2 rounded-full\">\r\n            Search\r\n          </Button>\r\n        </div>\r\n      </form>\r\n\r\n      {isImageSearchActive && (\r\n        <div className=\"mt-4\">\r\n          <form onSubmit={handleImageSearch} className=\"space-y-4\">\r\n            <div className=\"border-2 border-dashed border-gray-300 rounded-3xl p-6 text-center\">\r\n              {imagePreview ? (\r\n                <div className=\"flex flex-col items-center\">\r\n                  <img\r\n                    src={imagePreview}\r\n                    alt=\"Car preview\"\r\n                    className=\"h-40 object-contain mb-4\"\r\n                  />\r\n                  <Button\r\n                    variant=\"outline\"\r\n                    onClick={() => {\r\n                      setSearchImage(null);\r\n                      setImagePreview(\"\");\r\n                      toast.info(\"Image removed\");\r\n                    }}\r\n                  >\r\n                    Remove Image\r\n                  </Button>\r\n                </div>\r\n              ) : (\r\n                <div {...getRootProps()} className=\"cursor-pointer\">\r\n                  <input {...getInputProps()} />\r\n                  <div className=\"flex flex-col items-center\">\r\n                    <Upload className=\"h-12 w-12 text-gray-400 mb-2\" />\r\n                    <p className=\"text-gray-500 mb-2\">\r\n                      {isDragActive && !isDragReject\r\n                        ? \"Leave the file here to upload\"\r\n                        : \"Drag & drop a car image or click to select\"}\r\n                    </p>\r\n                    {isDragReject && (\r\n                      <p className=\"text-red-500 mb-2\">Invalid image type</p>\r\n                    )}\r\n                    <p className=\"text-gray-400 text-sm\">\r\n                      Supports: JPG, PNG (max 5MB)\r\n                    </p>\r\n                  </div>\r\n                </div>\r\n              )}\r\n            </div>\r\n\r\n            {imagePreview && (\r\n              <Button\r\n                type=\"submit\"\r\n                className=\"w-full\"\r\n                disabled={isUploading || isProcessing}\r\n              >\r\n                {isUploading\r\n                  ? \"Uploading...\"\r\n                  : isProcessing\r\n                  ? \"Analyzing image...\"\r\n                  : \"Search with this Image\"}\r\n              </Button>\r\n            )}\r\n          </form>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1090, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}}]
}